<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>The Bioconductor project: S4 classes in Bioconductor</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png"><link rel="manifest" href="favicons/incubator/site.webmanifest"><link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/05-s4.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      The Bioconductor project
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            The Bioconductor project
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html"></a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  The Bioconductor project
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 44%" class="percentage">
    44%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 44%" aria-valuenow="44" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/05-s4.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-setup.html">1. Introduction and setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-introduction-to-bioconductor.html">2. Introduction to Bioconductor</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-installing-bioconductor.html">3. Installing Bioconductor packages</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-getting-help.html">4. Getting help</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. S4 classes in Bioconductor
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#install-packages">Install packages</a></li>
<li><a href="#s4-classes-and-methods">S4 classes and methods</a></li>
<li><a href="#the-s4vectors-package">The S4Vectors package</a></li>
<li><a href="#the-dataframe-class">The DataFrame class</a></li>
<li><a href="#run-length-encoding-rle">Run-length encoding (RLE)</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-biological-sequences.html">6. Working with biological sequences</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-genomic-ranges.html">7. Working with genomics ranges</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-annotations.html">8. Working with annotations</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-summarizedexperiment.html">9. The SummarizedExperiment class</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html"></a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-getting-help.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-biological-sequences.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-getting-help.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Getting help
        </a>
        <a class="chapter-link float-end" href="06-biological-sequences.html" rel="next">
          Next: Working with...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>S4 classes in Bioconductor</h1>
        <p>Last updated on 2025-06-09 |

        <a href="https://github.com/carpentries-incubator/bioc-project/edit/main/episodes/05-s4.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is the S4 class system?</li>
<li>How does Bioconductor use S4 classes?</li>
<li>How is the Bioconductor <code>DataFrame</code> different from the
base <code>data.frame</code>?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain what S4 classes, generics, and methods are.</li>
<li>Identify S4 classes at the core of the Bioconductor package
infrastructure.</li>
<li>Create various S4 objects and apply relevant S4 methods.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="install-packages">Install packages<a class="anchor" aria-label="anchor" href="#install-packages"></a></h2>
<hr class="half-width"><p>Before we can proceed into the following sections, we install some
Bioconductor packages that we will need. First, we check that the <em><a href="https://bioconductor.org/packages/3.19/BiocManager" class="external-link">BiocManager</a></em>
package is installed before trying to use it; otherwise we install it.
Then we use the <code>BiocManager::install()</code> function to install
the necessary packages.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">requireNamespace</span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">install.packages</span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"S4Vectors"</span><span class="op">)</span></span></code></pre>
</div>
<div id="for-instructors" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="for-instructors" class="callout-inner">
<h3 class="callout-title">For Instructors</h3>
<div class="callout-content">
<p>The first part of this episode may look somewhat heavy on the theory.
Do not be tempted to go into excessive details about the inner workings
of the S4 class system (e.g., no need to mention the function
<code>new()</code>, or to demonstrate a concrete example of code
creating a class). Instead, the caption of the first figure demonstrates
how to progressively talk through the figure, introducing technical
terms in simple sentences, building up to the method dispatch concept
that is core to the S4 class system, and the source of much confusion in
novice users.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="s4-classes-and-methods">S4 classes and methods<a class="anchor" aria-label="anchor" href="#s4-classes-and-methods"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="the-methods-package">The methods package<a class="anchor" aria-label="anchor" href="#the-methods-package"></a></h3>
<p>The S4 class system is implemented in the base package <a href="https://stat.ethz.ch/R-manual/R-devel/library/methods/html/00Index.html" class="external-link">methods</a>.
As such, the concept is not specific to the Bioconductor project and can
be found in various independent packages as well. The subject is
thoroughly documented in the online book <a href="https://adv-r.had.co.nz/S4.html" class="external-link">Advanced R</a>, by Hadley
Wickham. Most Bioconductor users will never need to get overly familiar
with the intricacies of the S4 class system. Rather, the key to an
efficient use of packages in the Bioconductor project relies on a
sufficient understanding of key motivations for using the S4 class
system, as well as best practices for user-facing functionality,
including classes, generics, and methods. In the following sections of
this episode, we focus on the essential functionality and user
experience of S4 classes and methods in the context of the Bioconductor
project.</p>
<p>On one side, <a href="reference.html#s4-class">S4 classes</a> provide
data structures capable of storing arbitrarily complex information in
computational objects that can be assigned to variable names in an R
session. On the other side, <a href="reference.html#s4-method">S4
generics and methods</a> define functions that may be applied to process
those objects.</p>
<p>Over the years, the Bioconductor project has used the S4 class system
to develop a number of classes and methods capable of storing and
processing data for most biological assays, including raw and processed
assay data, experimental metadata for individual features and samples,
as well as other assay-specific information as relevant. Gaining
familiarity with the standard S4 classes commonly used throughout
Bioconductor packages is a key step in building up confidence in users
wishing to follow best practices while developing analytical
workflows.</p>
<figure><img src="fig/bioc-s4.svg" alt="S4 classes, generics, and methods." class="figure mx-auto d-block"></figure><p><strong>S4 classes, generics, and methods.</strong> On the left, two
example classes named <code>S4Class1</code> and <code>S4Class2</code>
demonstrate the concept of inheritance. The class <code>S4Class1</code>
contains two slots named <code>SlotName1</code> and
<code>SlotName2</code> for storing data. Those two slots are restricted
to store objects of type <code>SlotType1</code> and
<code>SlotType2</code>, respectively. The class also defines validity
rules that check the integrity of data each time an object is updated.
The class <code>S4Class2</code> inherits all the slots and validity
rules from the class <code>S4Class1</code>, in addition to defining a
new slot named <code>SlotName3</code> and new validity rules. Example
code illustrates how objects of each class are typically created using
constructor functions named identically to the corresponding class. On
the right, one generic function and two methods demonstrate the concept
of polymorphism and the process of S4 method dispatch. The generic
function <code>S4Generic1()</code> defines the name of the function, as
well as its arguments. However, it does not provide any implementation
of that function. Instead, two methods are defined, each providing a
distinct implementation of the generic function for a particular class
of input. Namely, the first method defines an implementation of
<code>S4Generic1()</code> if an object of class <code>S4Class1</code> is
given as argument <code>x</code>, while the second method method
provides a different implementation of <code>S4Generic1()</code> if an
object of class <code>S4Class2</code> is given as argument
<code>x</code>. When the generic function <code>S4Generic1()</code> is
called, a process called <a href="reference.html#s4-method-dispatch">method dispatch</a> takes
place, whereby the appropriate implementation of the
<code>S4Generic1()</code> method is called according to the class of the
object passed to the argument <code>x</code>.</p>
</div>
<div class="section level3">
<h3 id="slots-and-validity">Slots and validity<a class="anchor" aria-label="anchor" href="#slots-and-validity"></a></h3>
<p>In contrast to the S3 class system available directly in base R (not
described in this lesson), the S4 class system provides a much stricter
definition of classes and methods for object-oriented programming (OOP)
in R. Like many programming languages that implement the OOP model, S4
classes are used to represent real-world entities as computational
objects that store information inside one or more internal components
called <em>slots</em>. The class definition declares the type of data
that may be stored in each slot; an error will be thrown if one would
attempt to store unsuitable data. Moreover, the class definition can
also include code that checks the validity of data stored in an object,
beyond their type. For instance, while a slot of type
<code>numeric</code> could be used to store a person’s age, but a
validity method could check that the value stored is, in fact,
positive.</p>
</div>
<div class="section level3">
<h3 id="inheritance">Inheritance<a class="anchor" aria-label="anchor" href="#inheritance"></a></h3>
<p>One of the core pillars of the OOP model is the possibility to
develop new classes that inherit and extend the functionality of
existing classes. The S4 class system implements this paradigm.</p>
<p>The definition of a new S4 classes can declare the name of other
classes to inherit from. The new classes will contain all the slots of
the parent class, in addition to any new slot added in the definition of
the new class itself.</p>
<p>The new class definition can also define new validity checks, which
are added to any validity check implement in each of the parent
classes.</p>
</div>
<div class="section level3">
<h3 id="generics-and-methods">Generics and methods<a class="anchor" aria-label="anchor" href="#generics-and-methods"></a></h3>
<p>While classes define the data structures that store information,
generics and methods define the functions that can be applied to objects
instantiated from those classes.</p>
<p>S4 generic functions are used to declare the name of functions that
are expected to behave differently depending on the class of objects
that are given as some of their essential arguments. Instead, S4 methods
are used define the distinct implementations of a generic function for
each particular combination of inputs.</p>
<p>When a generic function is called and given an S4 object, a process
called <a href="reference.html#s4-method-dispatch">method dispatch</a>
takes place, whereby the class of the object is used to determine the
appropriate method to execute.</p>
</div>
</section><section><h2 class="section-heading" id="the-s4vectors-package">The S4Vectors package<a class="anchor" aria-label="anchor" href="#the-s4vectors-package"></a></h2>
<hr class="half-width"><p>The <em><a href="https://bioconductor.org/packages/3.19/S4Vectors" class="external-link">S4Vectors</a></em>
package defines the <code>Vector</code> and <code>List</code> virtual
classes and a set of generic functions that extend the semantic of
ordinary vectors and lists in R. Using the S4 class system, package
developers can easily implement vector-like or list-like objects as
concrete subclasses of <code>Vector</code> or <code>List</code>.</p>
<p>Virtual classes – such as <code>Vector</code> and <code>List</code> –
cannot be instantiated into objects themselves. Instead, those virtual
classes provide core functionality inherited by all the concrete classes
that are derived from them.</p>
<p>Instead, a few low-level concrete subclasses of general interest
(e.g. <code>DataFrame</code>, <code>Rle</code>, and <code>Hits</code>)
are implemented in the <em><a href="https://bioconductor.org/packages/3.19/S4Vectors" class="external-link">S4Vectors</a></em>
package itself, and many more are implemented in other packages
throughout the Bioconductor project (e.g., <em><a href="https://bioconductor.org/packages/3.19/IRanges" class="external-link">IRanges</a></em>).</p>
<p>Attach the package to the current R session as follows.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">S4Vectors</span><span class="op">)</span></span></code></pre>
</div>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>The package startup messages printed in the console are worth noting
that the <em><a href="https://bioconductor.org/packages/3.19/S4Vectors" class="external-link">S4Vectors</a></em>
package masks a number of functions from the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/00Index.html" class="external-link">base</a>
package when the package is attached to the session. This means that the
<em><a href="https://bioconductor.org/packages/3.19/S4Vectors" class="external-link">S4Vectors</a></em>
package includes an implementation of those functions, and that – being
the latest package attached to the R session – its own implementation of
those functions will be found first on the R search path and used
instead of their original implementation in the <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/00Index.html" class="external-link">base</a>
package.</p>
<p>In many cases, masked functions can be used as before without any
issue. Occasionally, it may be necessary to disambiguate calls to masked
function using the package name as well as the function name,
e.g. <code>base::anyDuplicated()</code>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="the-dataframe-class">The DataFrame class<a class="anchor" aria-label="anchor" href="#the-dataframe-class"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="an-extension-to-the-concept-of-rectangular-data">An extension to the concept of rectangular data<a class="anchor" aria-label="anchor" href="#an-extension-to-the-concept-of-rectangular-data"></a></h3>
<p>The <code>DataFrame</code> class implemented in the <em><a href="https://bioconductor.org/packages/3.19/S4Vectors" class="external-link">S4Vectors</a></em>
package extends the concept of rectangular data familiar to users of the
<code>data.frame</code> class in base R, or <code>tibble</code> in the
tidyverse. Specifically, the <code>DataFrame</code> supports the storage
of any type of object (with <code>length</code> and <code>[</code>
methods) as columns.</p>
<p>On the whole, the <code>DataFrame</code> class provides a formal
definition of an S4 class that behaves very similarly to
<code>data.frame</code>, in terms of construction, subsetting,
splitting, combining, etc.</p>
<p>The <code>DataFrame()</code> constructor function should be used to
create new objects, comparably to the <code>data.frame()</code>
equivalent in base R. The help page for the function, accessible as
<code>?DataFrame</code>, can be consulted for more information.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF1</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span></span>
<span>    Integers <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>,</span>
<span>    Letters <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>    Floats <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">2.3</span>, <span class="fl">3.4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">DF1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>DataFrame with 3 rows and 3 columns
   Integers     Letters    Floats
  &lt;integer&gt; &lt;character&gt; &lt;numeric&gt;
1         1           A       1.2
2         2           B       2.3
3         3           C       3.4</code></pre>
</div>
<p>In fact, <code>DataFrame</code> objects can be easily converted to
equivalent <code>data.frame</code> objects.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="va">DF1</span><span class="op">)</span></span>
<span><span class="va">df1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Integers Letters Floats
1        1       A    1.2
2        2       B    2.3
3        3       C    3.4</code></pre>
</div>
<p>Vice versa, we can also convert <code>data.frame</code> objects to
<code>DataFrame</code> using the <code>as()</code> function.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as</span><span class="op">(</span><span class="va">df1</span>, <span class="st">"DataFrame"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>DataFrame with 3 rows and 3 columns
   Integers     Letters    Floats
  &lt;integer&gt; &lt;character&gt; &lt;numeric&gt;
1         1           A       1.2
2         2           B       2.3
3         3           C       3.4</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="differences-with-the-base-data-frame">Differences with the base data.frame<a class="anchor" aria-label="anchor" href="#differences-with-the-base-data-frame"></a></h3>
<p>The most notable exceptions have to do with handling of row names.
First, row names are optional. This means calling
<code>rownames(x)</code> will return <code>NULL</code> if there are no
row names.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rownames</span><span class="op">(</span><span class="va">DF1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="cn">NULL</span></span></code></pre>
</div>
<p>This is different from <code>data.frame</code>, where
<code>rownames(x)</code> returns the equivalent of
<code>as.character(seq_len(nrow(x)))</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rownames</span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1" "2" "3"</code></pre>
</div>
<p>However, returning <code>NULL</code> informs, for example,
combination functions that no row names are desired (they are often a
luxury when dealing with large data).</p>
<p>Furthermore, row names of <code>DataFrame</code> objects are not
required to be unique, in contrast to the <code>data.frame</code> in
base R. Row names are a frequent source of controversy in R, as they can
be used to uniquely identify and index observations in rectangular
format, without storing that information explicitly in a dedicated
column. When set, row names can be used to subset rectangular data using
the <code>[</code> operator. Meanwhile, non-unique row names defeat that
purpose and can lead to unexpected results, as only the first occurrence
of each selected row name is extracted. Instead, the tidyverse
<code>tibble</code> removed the ability to set row names altogether,
forcing users to store every bit of information explicitly in dedicated
columns, while providing functions to dedicated to efficiently filtering
rows in rectangular data, without the need for the <code>[</code>
operator.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF2</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span></span>
<span>    Integers <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>,</span>
<span>    Letters <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>    Floats <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">2.3</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"name1"</span>, <span class="st">"name1"</span>, <span class="st">"name2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">DF2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>DataFrame with 3 rows and 3 columns
       Integers     Letters    Floats
      &lt;integer&gt; &lt;character&gt; &lt;numeric&gt;
name1         1           A       1.2
name1         2           B       2.3
name2         3           C       3.4</code></pre>
</div>
<div id="challenge" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge" class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Using the example above, what does <code>DF2["name1", ]</code>
return? Why?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<pre><code>&gt; DF2["name1", ]
DataFrame with 1 row and 3 columns
       Integers     Letters    Floats
      &lt;integer&gt; &lt;character&gt; &lt;numeric&gt;
name1         1           A       1.2</code></pre>
<p>Only the first occurrence of a row matching the row name
<code>name1</code> is returned.</p>
<p>In this case, row names do not have a particular meaning, making it
difficult to justify the need for them. Instead, users could extract all
the rows that matching the row name <code>name1</code> more explicitly
as follows: <code>DF2[rownames(DF2) == "name1", ]</code>.</p>
<p>Users should be mindful of the motivation for using row names in any
given situation; what they represent, and how they should be used during
the analysis.</p>
</div>
</div>
</div>
</div>
<p>Finally, row names in <code>DataFrame</code> do not support partial
matching during subsetting, in contrast to <code>data.frame</code>. The
stricter behaviour of <code>DataFrame</code> prevents often unexpected
results faced by unsuspecting users.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF3</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span></span>
<span>    Integers <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>,</span>
<span>    Letters <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>    Floats <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">2.3</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="va">DF3</span><span class="op">)</span></span></code></pre>
</div>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Using the examples above, what are the outputs of
<code>DF3["a", ]</code> and <code>df3["a", ]</code>? Why are they
different?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<pre><code>&gt; DF3["a", ]
DataFrame with 1 row and 3 columns
      Integers     Letters    Floats
     &lt;integer&gt; &lt;character&gt; &lt;numeric&gt;
&lt;NA&gt;        NA          NA        NA
&gt; df3["a", ]
      Integers Letters Floats
alpha        1       A    1.2</code></pre>
<p>The <code>DataFrame</code> object did not perform partial row name
matching, and thus did not match any row and return a
<code>DataFrame</code> full of <code>NA</code> values. Instead, the
<code>data.frame</code> object performed partial row name matching,
matched the requested <code>"a"</code> to the <code>"alpha"</code> row
name, and returned the corresponding row as a new
<code>data.frame</code> object.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="indexing">Indexing<a class="anchor" aria-label="anchor" href="#indexing"></a></h3>
<p>Just like a regular <code>data.frame</code>, columns can be accessed
using <code>$</code>, <code>[</code>, and <code>[[</code>. Each operator
has a different purpose, and the most appropriate one will often depend
on what you are trying to achieve.</p>
<p>For example, the dollar operator <code>$</code> can be used to
extract a single column by name. That will often be a vector, but it may
depend on the nature of the data in that column. This operator can be
quite convenient in an interactive R session, as it will offer
autocompletion among available column names.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF3</span><span class="op">$</span><span class="va">Integers</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3</code></pre>
</div>
<p>Similarly, the double bracket operator <code>[[</code> can also be
used to extract a single column. It is more flexible than <code>$</code>
as it can handle both character names and integer indices.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF3</span><span class="op">[[</span><span class="st">"Letters"</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "A" "B" "C"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "A" "B" "C"</code></pre>
</div>
<p>The operator <code>[</code> is most convenient when it comes to
selecting simultaneously on rows and columns, or controlling whether a
single-column selection should be returned as a <code>DataFrame</code>
or a <code>vector</code>.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF3</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"Letters"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>DataFrame with 2 rows and 1 column
          Letters
      &lt;character&gt;
beta            B
gamma           C</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="metadata-columns">Metadata columns<a class="anchor" aria-label="anchor" href="#metadata-columns"></a></h3>
<p>One of most notable novel functionality in <code>DataFrame</code>
relative to the base <code>data.frame</code> is the capacity to hold
metadata on the columns in another <code>DataFrame</code>.</p>
<figure><img src="fig/dataframe-mcols.svg" alt="Metadata columns." class="figure mx-auto d-block"></figure><p><strong>Metadata columns.</strong> Metadata columns are illustrated
in the context of a <code>DataFrame</code> object. On the left, a
<code>DataFrame</code> object called <code>DF</code> is created with
columns named <code>A</code> and <code>B</code>. On the right, the
metadata columns for <code>DF</code> are accessed using
<code>mcols(DF)</code>. In this example, two metadata columns are
created with names <code>meta1</code> and <code>meta2</code>. Metadata
columns are stored as a <code>DataFrame</code> that contains one row for
each column in the parent <code>DataFrame</code>.</p>
<p>The metadata columns are accessed using the function
<code>mcols()</code>, If no metadata column is defined,
<code>mcols()</code> simply returns <code>NULL.</code></p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF4</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span></span>
<span>    Integers <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span>,</span>
<span>    Letters <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>    Floats <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">2.3</span>, <span class="fl">3.4</span><span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">mcols</span><span class="op">(</span><span class="va">DF4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="cn">NULL</span></span></code></pre>
</div>
<p>The function <code>mcols()</code> can also be used to add, edit, or
remove metadata columns. For instance, we can initialise metadata
columns as a <code>DataFrame</code> of two columns:</p>
<ul><li>one column indicating the type of value stored in the corresponding
column</li>
<li>one column indicating the number of distinct values observed in the
corresponding column</li>
</ul><div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mcols</span><span class="op">(</span><span class="va">DF4</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span></span>
<span>    Type <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">DF4</span>, <span class="va">typeof</span><span class="op">)</span>,</span>
<span>    Distinct <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">DF4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fu">length</span><span class="op">(</span><span class="fu">unique</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span> <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">mcols</span><span class="op">(</span><span class="va">DF4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>DataFrame with 3 rows and 2 columns
                Type  Distinct
         &lt;character&gt; &lt;integer&gt;
Integers     integer         3
Letters    character         3
Floats        double         3</code></pre>
</div>
<div id="note-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-1" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>The row names of the metadata columns are automatically set to match
the column names of the parent <code>DataFrame</code>, clearly
indicating the pairing between columns and metadata.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="run-length-encoding-rle">Run-length encoding (RLE)<a class="anchor" aria-label="anchor" href="#run-length-encoding-rle"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="an-extension-to-the-concept-of-vector">An extension to the concept of vector<a class="anchor" aria-label="anchor" href="#an-extension-to-the-concept-of-vector"></a></h3>
<p>Similarly to the <code>DataFrame</code> class implemented in the
<em><a href="https://bioconductor.org/packages/3.19/S4Vectors" class="external-link">S4Vectors</a></em>,
the <code>Rle</code> class provides an S4 extension to the
<code>rle()</code> function from the base package. Specifically, the
<code>Rle</code> class supports the storage of atomic vectors in a
run-length encoding format.</p>
<figure><img src="fig/rle.svg" alt="Run-length encoding." class="figure mx-auto d-block"></figure><p><strong>Run-length encoding.</strong> The concept of run-length
encoding is demonstrated here using the example of a sequence of nucleic
acids. Before encoding, each nucleotide at each position in the sequence
is explicitly stored in memory. During the encoding, consecutive runs of
identical nucleotides are collapsed into two bits of information: the
identity of the nucleotide and the length of the run.</p>
<p>Run-length encoding can dramatically reduce the memory footprint of
vectors that contain frequent runs of identical information. For
instance, a compelling application of run-length encoding is the
representation of genomic coverage in sequencing experiments, where
large genomic regions devoid of any mapped reads result in long runs of
<code>0</code> values. Storing each individual value would be highly
inefficient from the standpoint of memory usage. Instead, the run-length
encoding process collapses such runs of redundant information from
arbitrarily long runs of identical information to two values: the
repeated value itself, and the number of times that it is repeated.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">rle1</span> <span class="op">&lt;-</span> <span class="fu">Rle</span><span class="op">(</span><span class="va">v1</span><span class="op">)</span></span>
<span><span class="va">rle1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>numeric-Rle of length 17 with 7 runs
  Lengths: 7 1 1 1 1 1 5
  Values : 0 1 2 3 2 1 0</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="indexing-1">Indexing<a class="anchor" aria-label="anchor" href="#indexing-1"></a></h3>
<p>Just like a regular <code>vector</code>, <code>Rle</code> objects can
be indexed using <code>[</code>.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rle1</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>numeric-Rle of length 3 with 1 run
  Lengths: 3
  Values : 0</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h3>
<p>As vector-like objects, <code>Rle</code> objects can also be stored
as columns of <code>DataFrame</code> objects, alongside other
vector-like objects.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rle2</span> <span class="op">&lt;-</span> <span class="fu">Rle</span><span class="op">(</span><span class="va">v2</span><span class="op">)</span></span>
<span><span class="va">DF5</span> <span class="op">&lt;-</span> <span class="fu">DataFrame</span><span class="op">(</span></span>
<span>    vector <span class="op">=</span> <span class="va">v2</span>,</span>
<span>    rle <span class="op">=</span> <span class="va">rle2</span>,</span>
<span>    equal <span class="op">=</span> <span class="va">v2</span> <span class="op">==</span> <span class="va">rle2</span></span>
<span><span class="op">)</span></span>
<span><span class="va">DF5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>DataFrame with 10 rows and 3 columns
      vector   rle equal
   &lt;numeric&gt; &lt;Rle&gt; &lt;Rle&gt;
1          1     1  TRUE
2          1     1  TRUE
3          1     1  TRUE
4          1     1  TRUE
5          1     1  TRUE
6          2     2  TRUE
7          2     2  TRUE
8          2     2  TRUE
9          2     2  TRUE
10         2     2  TRUE</code></pre>
</div>
<div id="going-further" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="going-further" class="callout-inner">
<h3 class="callout-title">Going further</h3>
<div class="callout-content">
<p>A number of standard operations with <code>Rle</code> objects are
documented in the help page of the <code>Rle</code> class, accessible as
<code>?Rle</code>, and in the vignettes of the <em><a href="https://bioconductor.org/packages/3.19/S4Vectors" class="external-link">S4Vectors</a></em>
package, accessible using <code>browseVignettes("S4Vectors")</code>.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>S4 classes store information in slots, and check the validity of the
information every an object is updated.</li>
<li>To ensure the continued integrity of S4 objects, users should not
access slots directly, but using dedicated functions.</li>
<li>S4 generics invoke different implementations of the method depending
on the class of the object that they are given.</li>
<li>The S4 class <code>DataFrame</code> extends the functionality of
base <code>data.frame</code>, for instance with the capacity to hold
information about each column in metadata columns.</li>
<li>The S4 class <code>Rle</code> extends the functionality of the base
<code>vector</code>, for instance with the capacity to encode repetitive
vectors in a memory-efficient format.</li>
</ul></div>
</div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-getting-help.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-biological-sequences.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-getting-help.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Getting help
        </a>
        <a class="chapter-link float-end" href="06-biological-sequences.html" rel="next">
          Next: Working with...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/bioc-project/edit/main/episodes/05-s4.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/bioc-project/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/bioc-project/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/bioc-project/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://carpentries-incubator.github.io/bioc-project/05-s4.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "S4 classes in Bioconductor",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/bioc-project/05-s4.html",
  "identifier": "https://carpentries-incubator.github.io/bioc-project/05-s4.html",
  "dateCreated": "2020-09-14",
  "dateModified": "2025-06-09",
  "datePublished": "2025-06-10"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

